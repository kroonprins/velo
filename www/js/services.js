'use strict';

/* Services */

var veloServices = angular.module('veloServices', ['ngStorage']);

veloServices.factory('VeloService', ['$http','$localStorage',
  function($http, $localStorage){
	  var interval = 60000; // 60s
	  var lastInvocationTimestamp = 0;
	  var data = null;
	  var service = {
		getSavedStations : function(station){
			if(!$localStorage.savedStations) {
				$localStorage.savedStations = [];
			}
			return $localStorage.savedStations;
		},
		setSavedStations : function(savedStations){
			if(!savedStations) {
				$localStorage.savedStations = savedStations;
			}
		},
		addSavedStation : function(station){
			if(!$localStorage.savedStations) {
				$localStorage.savedStations = [];
			}
                  	var index = $localStorage.savedStations.indexOf(station.id);
                  	if (index < 0) {
                        	$localStorage.savedStations.push(station.id);
                  	}
                  	station.saved = true;
		},
		removeSavedStation : function(station){
			if(!$localStorage.savedStations) {
				$localStorage.savedStations = [];
			}
                	var index = $localStorage.savedStations.indexOf(station.id);
                	if (index >= 0) {
                        	$localStorage.savedStations.splice(index,1);
                	}
                	station.saved = false;
		},
	  	retrieveAndUpdateScope : function(scope, force) {
			scope.isSearching=true;
			/*service.retrieve().then(function(d) {
				scope.veloResponse = d;
				scope.isSearching=false;
			});*/
			scope.veloResponse = service.retrieve(force);
			scope.isSearching=false;
		},
	  	retrieve : function(force) {
			if(!force){
				// if it is not requested to force the call then we check if we can return the cached result
				var currentTimestamp = Date.now();
				if(data && currentTimestamp - lastInvocationTimestamp < interval){
					return data;
				}
			}
			lastInvocationTimestamp = currentTimestamp;
		  	/*var promise = $http.get('https://www.velo-antwerpen.be/availability_map/getJsonObject')
				.then(function(response) {
					$.map(response.data, function(val) {
                    				val.name = val.name.substring(0,3)+" - "+val.name.substring(5);
		                        	val.saved = $.inArray(val.id,$localStorage.savedStations) > -1; 
			                });
					data = response.data;
					return data;
				},
    				function(data) {
					console.log("Error calling Velo "+JSON.stringify(data,null,4));
  				 });
			return promise;*/
			data = [{"id":"1","district":"1","lon":"4.420650000000000000","lat":"51.21782000000000000","bikes":"10","slots":"22","zip":"2018","address":"Koningin Astridplein","addressNumber":null,"nearbyStations":"3,4,5,24","status":"OPN","name":"001- Centraal Station - Astrid"},{"id":"2","district":"1","lon":"4.420750000000000000","lat":"51.21758000000000000","bikes":"25","slots":"31","zip":"2018","address":"Koningin Astridplein","addressNumber":" tov st1","nearbyStations":"3,4,5,24","status":"OPN","name":"002- Centraal Station - Astrid 2"},{"id":"3","district":null,"lon":"4.421771338842944000","lat":"51.21308585312569000","bikes":"19","slots":"11","zip":"2018","address":"Kievitplein","addressNumber":"tov st 5","nearbyStations":"1,2,4,6","status":"OPN","name":"003- Centraal station Kievit 2"},{"id":"4","district":"1","lon":"4.420094444444445000","lat":"51.21736388888889000","bikes":"9","slots":"12","zip":"2018","address":"De Keyserlei","addressNumber":"57","nearbyStations":"1,2,3,5","status":"OPN","name":"004- De Keyserlei"},{"id":"5","district":"1","lon":"4.421732916607050000","lat":"51.21301072974409000","bikes":"27","slots":"9","zip":"2018","address":"Lange Kievitstraat","addressNumber":"n\u00b070","nearbyStations":"1,2,4,6","status":"OPN","name":"005- Centraal Station \/ Kievit"},{"id":"6","district":null,"lon":"4.422179962645858000","lat":"51.21031666135904000","bikes":"6","slots":"18","zip":"2018","address":"Mercatorstraat ","addressNumber":"tov 18","nearbyStations":"5,104,111,116","status":"OPN","name":"006- Premetro Plantin"},{"id":"7","district":"1","lon":"4.433947713271024000","lat":"51.20107584716423000","bikes":"26","slots":"10","zip":"2600","address":"Binnensingel ingang station Berchem","addressNumber":null,"nearbyStations":"22,97,106,112","status":"OPN","name":"007- NMBS Berchem "},{"id":"8","district":null,"lon":"4.433958407621510000","lat":"51.20108907303041000","bikes":"14","slots":"16","zip":"2600","address":"Ryckaertplein","addressNumber":null,"nearbyStations":"22,97,106,112","status":"OPN","name":"008- NMBS Berchem 2"},{"id":"9","district":"1","lon":"4.437700892649170000","lat":"51.20896521707293000","bikes":"12","slots":"6","zip":"2140","address":"Wilrijkstraat - Plantin Moretuslei","addressNumber":null,"nearbyStations":"69,105,110,132","status":"OPN","name":"009- NMBS Oost"},{"id":"10","district":"1","lon":"4.390718261329017000","lat":"51.19846968971121000","bikes":"16","slots":"19","zip":"2018","address":"Desguinlei - Montignystraat","addressNumber":null,"nearbyStations":"12,40,86,87","status":"OPN","name":"010- NMBS Zuid"},{"id":"11","district":"1","lon":"4.416330472403196000","lat":"51.21997793519735000","bikes":"0","slots":"24","zip":"2018","address":"Itali\u00eblei - Franklin Rooseveltplaats","addressNumber":null,"nearbyStations":"24,25,26,54","status":"OPN","name":"011- Roosevelt"},{"id":"12","district":null,"lon":"4.390135000000000000","lat":"51.19930600000000000","bikes":"5","slots":"31","zip":"2018","address":"De Singel\/ Brederodestraat","addressNumber":"1","nearbyStations":"10,40,86,87","status":"OPN","name":"012- Brussel"},{"id":"13","district":null,"lon":"4.402245000000000000","lat":"51.19388200000000000","bikes":"18","slots":"18","zip":null,"address":"Jan van rijswijcklaan aan bedrijf DE SINGEL","addressNumber":null,"nearbyStations":"14,31,40,131","status":"OPN","name":"013- De Singel"},{"id":"14","district":null,"lon":"4.405689000000000000","lat":"51.19681300000000000","bikes":"8","slots":"28","zip":"2018","address":"Jan Van Rijswijcklaan","addressNumber":"86","nearbyStations":"13,31,89,99","status":"OPN","name":"014- Markgrave"},{"id":"15","district":"1","lon":"4.394392340970182000","lat":"51.20782211517101000","bikes":"20","slots":"4","zip":"2000","address":"Beeldhouwersstraat - Admiraal De Boisotstraat","addressNumber":null,"nearbyStations":"16,75,80,83","status":"OPN","name":"015- Schone Kunsten"},{"id":"16","district":null,"lon":"4.396613000000000000","lat":"51.21016000000000000","bikes":"11","slots":"16","zip":"2000","address":"Karel Rogierstraat ","addressNumber":"8","nearbyStations":"15,72,74,83","status":"OPN","name":"016- Marnixplaats"},{"id":"17","district":"1","lon":"4.401197046278909000","lat":"51.21888424261340000","bikes":"12","slots":"6","zip":"2000","address":"Groenplaats n\u00b0 7","addressNumber":null,"nearbyStations":"19,60,64,66","status":"OPN","name":"017- Groenplaats"},{"id":"18","district":"1","lon":"4.406168081225285000","lat":"51.21818701003684000","bikes":"0","slots":"36","zip":"2000","address":"Meir n\u00b0 18","addressNumber":null,"nearbyStations":"17,19,20,23","status":"OPN","name":"018- Meirbrug"},{"id":"19","district":"1","lon":"4.403610000000000000","lat":"51.21924000000000000","bikes":"2","slots":"22","zip":"2000","address":"Eiermarkt ","addressNumber":"13","nearbyStations":"17,18,20,57","status":"OPN","name":"019- Eiermarkt"},{"id":"20","district":"1","lon":"4.401000000000000000","lat":"51.21880000000000000","bikes":"3","slots":"24","zip":"2000","address":"Groenkerkhofstraat\/Nationalestraat","addressNumber":null,"nearbyStations":"18,19,60,66","status":"OPN","name":"020- Groenplaats 2"},{"id":"21","district":null,"lon":"4.419189000000000000","lat":"51.19548200000000000","bikes":"13","slots":"17","zip":null,"address":"Grotesteenweg 150\/Driekoningenstraat","addressNumber":null,"nearbyStations":"46,61,100,103","status":"OPN","name":"021- Driekoningen"},{"id":"22","district":null,"lon":"4.430990359067499000","lat":"51.19992476161931000","bikes":"10","slots":"23","zip":"2600","address":"Statiestraat 162","addressNumber":null,"nearbyStations":"8,47,55,97","status":"OPN","name":"022- Statie"},{"id":"23","district":"1","lon":"4.408880661964794000","lat":"51.21708416292551000","bikes":"1","slots":"19","zip":"2018","address":"Wapper - Jodenstraat","addressNumber":null,"nearbyStations":"18,26,36,37","status":"OPN","name":"023- Rubenshuis"},{"id":"24","district":null,"lon":"4.416550159127468000","lat":"51.21791414153401000","bikes":"10","slots":"26","zip":"2018","address":"De Keyserlei\/Van Ertbornstraat","addressNumber":null,"nearbyStations":"1,2,4,25","status":"OPN","name":"024- Opera"},{"id":"25","district":"1","lon":"4.415447262420427000","lat":"51.21842196822108000","bikes":"1","slots":"29","zip":"2018","address":"Frankrijklei - Teniersplaats","addressNumber":null,"nearbyStations":"11,24,26,27","status":"OPN","name":"025- Teniersplaats"},{"id":"26","district":null,"lon":"4.412475243159753000","lat":"51.21822789177805000","bikes":"4","slots":"31","zip":"2000","address":"Meir 84","addressNumber":null,"nearbyStations":"23,24,25,27","status":"OPN","name":"026- Meir-Antoon Van Dijck"},{"id":"27","district":null,"lon":"4.411949186215027000","lat":"51.21950291247646000","bikes":"8","slots":"27","zip":"2000","address":"Lange Nieuwstraat 101","addressNumber":null,"nearbyStations":"11,24,25,26","status":"OPN","name":"027- Lange Nieuwstraat"},{"id":"28","district":"1","lon":"4.408659692889357000","lat":"51.22148804502052000","bikes":"5","slots":"18","zip":"2000","address":"Keizerstraat ro n\u00b0 56","addressNumber":null,"nearbyStations":"51,54,56,57","status":"OPN","name":"028- Keizerstraat"},{"id":"29","district":"1","lon":"4.406064590410548000","lat":"51.20177790228143000","bikes":"4","slots":"12","zip":"2018","address":"Lange Lozanastraat n\u00b0 149","addressNumber":null,"nearbyStations":"42,88,90,92","status":"OPN","name":"029- Lozana"},{"id":"30","district":null,"lon":"4.433518298737513000","lat":"51.21631845101857000","bikes":"8","slots":"16","zip":"2140","address":"Laar","addressNumber":"tov nr 16","nearbyStations":"107,108,109,113","status":"OPN","name":"030- Het Laar"},{"id":"31","district":"1","lon":"4.408029450760751000","lat":"51.19311916942493000","bikes":"9","slots":"12","zip":"2018","address":"Karel Oomsstraat - Binnensingel","addressNumber":null,"nearbyStations":"13,14,99,131","status":"OPN","name":"031- Wezenberg"},{"id":"32","district":"1","lon":"4.420708379829534000","lat":"51.22173485685548000","bikes":"4","slots":"23","zip":"2060","address":"De Conickplein ro n\u00b0 26","addressNumber":null,"nearbyStations":"1,4,11,115","status":"OPN","name":"032- Permeke"},{"id":"33","district":"1","lon":"4.409645771552839000","lat":"51.22621837372287000","bikes":"8","slots":"13","zip":"2000","address":"Hessenplein n\u00b0 2","addressNumber":null,"nearbyStations":"45,52,53,129","status":"OPN","name":"033- Hessenhuis"},{"id":"34","district":"1","lon":"4.390343681438131000","lat":"51.21101506600984000","bikes":"12","slots":"15","zip":"2000","address":"Leuvenstraat - Waalsekaai","addressNumber":null,"nearbyStations":"35,74,75,82","status":"OPN","name":"034- M HKA"},{"id":"35","district":null,"lon":"4.389800000000000000","lat":"51.21214000000000000","bikes":"15","slots":"15","zip":"2000","address":"cockerillkaai","addressNumber":null,"nearbyStations":"34,71,74,75","status":"OPN","name":"035- Cockerillkaai"},{"id":"36","district":"1","lon":"4.405926457819422000","lat":"51.21645368917724000","bikes":"2","slots":"19","zip":"2000","address":"Schuttershofstraat n\u00b0 2","addressNumber":null,"nearbyStations":"18,19,23,67","status":"OPN","name":"036- Bourla"},{"id":"37","district":"1","lon":"4.412371967260860000","lat":"51.21559347643882000","bikes":"6","slots":"23","zip":"2000","address":"Tabakvest - Ibis Hotel","addressNumber":null,"nearbyStations":"23,77,95,96","status":"OPN","name":"037- Theater"},{"id":"38","district":null,"lon":"4.432635000000000000","lat":"51.22015700000000000","bikes":"10","slots":"11","zip":null,"address":"Pastorijstraat tov huisnr28","addressNumber":null,"nearbyStations":"102,109,113,114","status":"OPN","name":"038- Pastorijstraat"},{"id":"39","district":"1","lon":"4.434095891498593000","lat":"51.21105908944124000","bikes":"15","slots":"21","zip":"2018","address":"Betogingstraat tov3","addressNumber":null,"nearbyStations":"9,105,107,132","status":"OPN","name":"039- Koxplein"},{"id":"40","district":"1","lon":"4.396619143599072000","lat":"51.19676193952913000","bikes":"11","slots":"25","zip":"2018","address":"Desguinlei to 246","addressNumber":null,"nearbyStations":"10,12,13,89","status":"OPN","name":"040- Desguinlei"},{"id":"41","district":"1","lon":"4.411606000000000000","lat":"51.21080200000000000","bikes":"15","slots":"12","zip":"2018","address":"Van Eycklei\/Edelinckstraat 24 ","addressNumber":null,"nearbyStations":"77,79,91,116","status":"OPN","name":"041- Van Eyck"},{"id":"42","district":"1","lon":"4.412070122941341000","lat":"51.20228489249466000","bikes":"3","slots":"17","zip":"2018","address":"Mechelsesteenweg - Ingang Harmoniepark","addressNumber":null,"nearbyStations":"29,43,92,93","status":"OPN","name":"042- Harmonie"},{"id":"43","district":null,"lon":"4.415281000000000000","lat":"51.20368400000000000","bikes":"7","slots":"23","zip":"2018","address":"Belgi\u00eblei\/Gretrystraat","addressNumber":null,"nearbyStations":"42,44,92,93","status":"OPN","name":"043- Gr\u00e9trystraat"},{"id":"44","district":"1","lon":"4.418194000000000000","lat":"51.20572100000000000","bikes":"16","slots":"20","zip":"2000","address":"Belgi\u00eblei 99","addressNumber":null,"nearbyStations":"42,43,93,130","status":"OPN","name":"044- Belgielei"},{"id":"45","district":"1","lon":"4.405497597996209000","lat":"51.22688177486824000","bikes":"3","slots":"14","zip":"2000","address":"Oude Leeuwenrui n\u00b0 2","addressNumber":null,"nearbyStations":"33,129,134,135","status":"OPN","name":"045- Falconplein"},{"id":"46","district":null,"lon":"4.415516549585612000","lat":"51.19910372113264000","bikes":"16","slots":"20","zip":"2600","address":"Grotesteenweg\/Boomgaardstraat","addressNumber":null,"nearbyStations":"42,98,99,100","status":"OPN","name":"046- De Merode"},{"id":"47","district":null,"lon":"4.423709521960564000","lat":"51.20140582840499000","bikes":"22","slots":"14","zip":"2600","address":"Boomgaardstraat\/Marialei","addressNumber":null,"nearbyStations":"22,97,98,130","status":"OPN","name":"047- Militair Hospitaal"},{"id":"50","district":null,"lon":"4.403024090372765000","lat":"51.22373281553696000","bikes":"4","slots":"17","zip":"2000","address":"Sint-Paulusstraat\/ Lange Koepoortstraat","addressNumber":null,"nearbyStations":"51,56,57","status":"OPN","name":"050- Klapdorp"},{"id":"51","district":null,"lon":"4.406112888467821000","lat":"51.22289620751177000","bikes":"3","slots":"21","zip":"2000","address":"Mutsaardplein","addressNumber":null,"nearbyStations":"28,50,56,57","status":"OPN","name":"051- Mutsaardplein"},{"id":"52","district":"1","lon":"4.414619531422663000","lat":"51.22583771218511000","bikes":"1","slots":"29","zip":"2000","address":"Itali\u00eblei n\u00b0 10","addressNumber":null,"nearbyStations":"33,53,117,127","status":"OPN","name":"052- Waaslandtunnel"},{"id":"53","district":"1","lon":"4.413298397408935000","lat":"51.22465145423593000","bikes":"1","slots":"20","zip":"2000","address":"Paardenmarkt - Kleine Kauwenberg","addressNumber":null,"nearbyStations":"33,52,54,117","status":"OPN","name":"053- Paardenmarkt"},{"id":"54","district":"1","lon":"4.412985000366758000","lat":"51.22185543876710000","bikes":"9","slots":"11","zip":"2000","address":"Pieter Van Hobokenstraat n\u00b0 19","addressNumber":null,"nearbyStations":"11,27,28,53","status":"OPN","name":"054- Ossenmarkt"},{"id":"55","district":null,"lon":"4.428231210627736000","lat":"51.19697723414253000","bikes":"10","slots":"23","zip":"2600","address":"Vredestraat\/Zonnebloemstraat","addressNumber":null,"nearbyStations":"7,22,61","status":"OPN","name":"055- Zonnebloemstraat"},{"id":"56","district":"1","lon":"4.404587621644557000","lat":"51.22218731074238000","bikes":"5","slots":"25","zip":"2000","address":"Minderbroederrui n\u00b0 46","addressNumber":null,"nearbyStations":"50,51,57,60","status":"OPN","name":"056- Minderbroedersrui"},{"id":"57","district":"1","lon":"4.402666666666667000","lat":"51.22154166666667000","bikes":"3","slots":"15","zip":"2000","address":"Wolstraat - Korte Koepoortstraat 2","addressNumber":null,"nearbyStations":"50,51,56,60","status":"OPN","name":"057- Wolstraat"},{"id":"58","district":"1","lon":"4.399097050370182000","lat":"51.22438942950193000","bikes":"5","slots":"25","zip":"2000","address":"Jordaenskaai ro Saucierstraat","addressNumber":null,"nearbyStations":"50,59,135","status":"OPN","name":"058- Noorderterras"},{"id":"59","district":"1","lon":"4.396804494276738000","lat":"51.22109922330606000","bikes":"22","slots":"12","zip":"2000","address":"Ernest Van Dijckkaai ro n\u00b0 13 - Zuiderterras","addressNumber":null,"nearbyStations":"17,20,60,64","status":"OPN","name":"059- Het Steen"},{"id":"60","district":"1","lon":"4.400512730484778000","lat":"51.22158761940871000","bikes":"14","slots":"22","zip":"2000","address":"Wisselstraat 9","addressNumber":null,"nearbyStations":"17,20,56,57","status":"OPN","name":"060- Grote Markt"},{"id":"61","district":null,"lon":"4.425406466971353000","lat":"51.19780966860766000","bikes":"11","slots":"25","zip":"2600","address":"Statiestraat - Victor Jacobslei","addressNumber":null,"nearbyStations":"7,21,22,55","status":"OPN","name":"061- Victor Jacobslei"},{"id":"62","district":null,"lon":"4.426978000000000000","lat":"51.23182800000000000","bikes":"4","slots":"19","zip":null,"address":"Damplein\/Lange lobroekstraat ro n\u00b0 222","addressNumber":null,"nearbyStations":"63,118,123,124","status":"OPN","name":"062- Station Dam"},{"id":"63","district":null,"lon":"4.431567000000000000","lat":"51.23001400000000000","bikes":"10","slots":"26","zip":null,"address":"Lange Lobroekstraat tov huisnr 93","addressNumber":null,"nearbyStations":"62,121,123","status":"OPN","name":"063- Slachthuis"},{"id":"64","district":"1","lon":"4.394899321136949000","lat":"51.21909214669883000","bikes":"14","slots":"21","zip":"2000","address":"Plantinkaai ro Jansvliet (Zuiderterras)","addressNumber":null,"nearbyStations":"17,20,59,65","status":"OPN","name":"064- Zuiderterras"},{"id":"65","district":"1","lon":"4.393691048333439000","lat":"51.21643455232020000","bikes":"8","slots":"21","zip":"2000","address":"Plantinkaai ro n\u00b027","addressNumber":null,"nearbyStations":"64,66,70,71","status":"OPN","name":"065- Plantinkaai"},{"id":"66","district":"1","lon":"4.399251391055215000","lat":"51.21708870223401000","bikes":"19","slots":"5","zip":"2000","address":"Drukkerijstraat n\u00b0 26","addressNumber":null,"nearbyStations":"17,20,64,67","status":"OPN","name":"066- Modemuseum"},{"id":"67","district":"1","lon":"4.403141962080859000","lat":"51.21577842083218000","bikes":"11","slots":"13","zip":"2000","address":"Oudaan n\u00b0 14","addressNumber":null,"nearbyStations":"18,23,36,66","status":"OPN","name":"067- Oudaan"},{"id":"68","district":null,"lon":"4.443683000000000000","lat":"51.21457100000000000","bikes":"11","slots":"19","zip":"2140","address":"Turnhoutsebaan\/Stenenbrug ","addressNumber":null,"nearbyStations":"69,107,108,132","status":"OPN","name":"068-  Turnhoutsepoort"},{"id":"69","district":null,"lon":"4.441964470690549000","lat":"51.21115942144159000","bikes":"6","slots":"30","zip":"2140","address":"Fonteinstraat tov 72","addressNumber":null,"nearbyStations":"9,39,68,132","status":"OPN","name":"069- Fonteinstraat"},{"id":"70","district":"1","lon":"4.396344222405702000","lat":"51.21484782149413000","bikes":"4","slots":"26","zip":"2000","address":"Sint Andriesplaats n\u00b0 24","addressNumber":null,"nearbyStations":"65,66,71,76","status":"OPN","name":"070- Sint Andries"},{"id":"71","district":"1","lon":"4.392818765521578000","lat":"51.21522882763002000","bikes":"17","slots":"13","zip":"2000","address":"Sint-Michielskaai ro n\u00b0 21","addressNumber":null,"nearbyStations":"35,65,70,74","status":"OPN","name":"071- Sint-Michielskaai"},{"id":"72","district":"1","lon":"4.398986182742563000","lat":"51.21187275413007000","bikes":"16","slots":"11","zip":"2000","address":"Kronenburgstraat ro n\u00b0 82","addressNumber":null,"nearbyStations":"16,73,74,76","status":"OPN","name":"072- Tropisch Instituut"},{"id":"73","district":null,"lon":"4.403718000000000000","lat":"51.21230900000000000","bikes":"9","slots":"27","zip":"2000","address":"Maarschalk Gerardstraat\/schermersstraat","addressNumber":null,"nearbyStations":"72,77,79,84","status":"OPN","name":"073- Maarschalk G\u00e9rard"},{"id":"74","district":"1","lon":"4.394022819445082000","lat":"51.21233419740909000","bikes":"10","slots":"8","zip":"2000","address":"Scheldestraat - Kronenburgstraat","addressNumber":null,"nearbyStations":"16,34,35,72","status":"OPN","name":"074- Vismijn"},{"id":"75","district":"1","lon":"4.390930567194764000","lat":"51.20976696683801000","bikes":"20","slots":"4","zip":"2000","address":"Vlaamsekaai 35","addressNumber":null,"nearbyStations":"15,34,35,82","status":"OPN","name":"075- Vlaamsekaai"},{"id":"76","district":null,"lon":"4.398093000000000000","lat":"51.21403500000000000","bikes":"0","slots":"24","zip":"2000","address":"Nationalestraat\/Lange Vlierstraat","addressNumber":null,"nearbyStations":"70,71,72,74","status":"OPN","name":"076- Prekersplein"},{"id":"77","district":null,"lon":"4.409466000000000000","lat":"51.21275300000000000","bikes":"22","slots":"14","zip":"2000","address":"Frankrijklei - Blauwetorenplein","addressNumber":null,"nearbyStations":"37,41,79,96","status":"OPN","name":"077- Blauwtorenplein"},{"id":"78","district":"1","lon":"4.403011521639670000","lat":"51.20920317182867000","bikes":"4","slots":"23","zip":"2000","address":"Britselei n\u00b0 82","addressNumber":null,"nearbyStations":"16,72,83,91","status":"OPN","name":"078- Oud Gerechtshof"},{"id":"79","district":"1","lon":"4.407260707520346000","lat":"51.21103450617727000","bikes":"11","slots":"12","zip":"2000","address":"Britselei - Mechelsesteenweg","addressNumber":null,"nearbyStations":"41,73,77,91","status":"OPN","name":"079- Nationale Bank"},{"id":"80","district":null,"lon":"4.393389834019567000","lat":"51.20607381800583000","bikes":"18","slots":"18","zip":null,"address":"Amerikalei\/Graaf Van Hoornestraat","addressNumber":null,"nearbyStations":"15,83,85,94","status":"OPN","name":"080- Montigny"},{"id":"81","district":"1","lon":"4.387671971509639000","lat":"51.20468073203386000","bikes":"18","slots":"9","zip":"2000","address":"Bolivarplaats rechts van het gerechtsgebouw","addressNumber":null,"nearbyStations":"80,82,86,94","status":"OPN","name":"081- Justitiepaleis"},{"id":"82","district":"1","lon":"4.387372992419973000","lat":"51.20877460178484000","bikes":"6","slots":"15","zip":"2000","address":"Verviersstraat - Waalsekaai","addressNumber":null,"nearbyStations":"34,35,74,75","status":"OPN","name":"082- Fotografiemuseum"},{"id":"83","district":"1","lon":"4.398509639357570000","lat":"51.20775287832413000","bikes":"5","slots":"22","zip":"2000","address":"Amerikalei n\u00b0 82","addressNumber":null,"nearbyStations":"15,16,80,85","status":"OPN","name":"083- Brederode"},{"id":"84","district":"1","lon":"4.404966647429536000","lat":"51.21344144039645000","bikes":"1","slots":"23","zip":"2000","address":"Lange Gasthuisstraat ro n\u00b0 3","addressNumber":null,"nearbyStations":"67,73,77,79","status":"OPN","name":"084- Elzenveld"},{"id":"85","district":"1","lon":"4.398812741627194000","lat":"51.20583236630190000","bikes":"20","slots":"16","zip":"2018","address":"Boudewijnsstraat tegenover n\u00b0 19-21","addressNumber":null,"nearbyStations":"15,80,83,94","status":"OPN","name":"085- Den Bell"},{"id":"86","district":"1","lon":"4.392348000000000000","lat":"51.20334900000000000","bikes":"7","slots":"20","zip":"2018","address":"Broederminstraat 59","addressNumber":null,"nearbyStations":"12,81,87,94","status":"OPN","name":"086- Troonplaats"},{"id":"87","district":"1","lon":"4.394213916060354000","lat":"51.20073119866322000","bikes":"3","slots":"18","zip":"2018","address":"Lange Elzenstraat n\u00b0 56","addressNumber":null,"nearbyStations":"10,12,40,86","status":"OPN","name":"087- Lange Elzen"},{"id":"88","district":"1","lon":"4.402212232689625000","lat":"51.20114051545752000","bikes":"1","slots":"19","zip":"2018","address":"Van Trierstraat - Haantjeslei","addressNumber":null,"nearbyStations":"14,29,89,90","status":"OPN","name":"088- Haantjeslei"},{"id":"89","district":"1","lon":"4.402230221840753000","lat":"51.19842591074800000","bikes":"15","slots":"6","zip":"2018","address":"Van Schoonbekestraat - Markgravelei","addressNumber":null,"nearbyStations":"13,14,40,88","status":"OPN","name":"089- Hof van Leysen"},{"id":"90","district":"1","lon":"4.404774275762020000","lat":"51.20454667572269000","bikes":"1","slots":"17","zip":"2018","address":"Vinkenstraat ro n\u00b0 7","addressNumber":null,"nearbyStations":"29,88,91,92","status":"OPN","name":"090- Ballaarstraat"},{"id":"91","district":"1","lon":"4.408297423288219000","lat":"51.20882346376338000","bikes":"7","slots":"11","zip":"2018","address":"Mechelsesteenweg n\u00b0 66","addressNumber":null,"nearbyStations":"41,73,78,79","status":"OPN","name":"091- Hemelstraat"},{"id":"92","district":"1","lon":"4.410634013269819000","lat":"51.20450961188838000","bikes":"13","slots":"8","zip":"2018","address":"Mechelsesteenweg n\u00b0 180","addressNumber":null,"nearbyStations":"29,42,43,93","status":"OPN","name":"092- Sint-Thomas"},{"id":"93","district":"1","lon":"4.413560000000000000","lat":"51.20541000000000000","bikes":"4","slots":"26","zip":"2000","address":"sint vincentius","addressNumber":"tov 61","nearbyStations":"42,43,44,92","status":"OPN","name":"093- Sint Vincentius"},{"id":"94","district":"1","lon":"4.396100000000000000","lat":"51.20480000000000000","bikes":"1","slots":"17","zip":"2018","address":"Paleisstraat ","addressNumber":"147","nearbyStations":"15,80,83,85","status":"OPN","name":"094- Paleisstraat"},{"id":"95","district":"1","lon":"4.416319522723214000","lat":"51.21415140431763000","bikes":"14","slots":"16","zip":"2018","address":"Quinten Mathijslei n\u00b0 12","addressNumber":null,"nearbyStations":"24,37,96,116","status":"OPN","name":"095- Quinten Matsijslei"},{"id":"96","district":"1","lon":"4.413109498483254000","lat":"51.21328214183770000","bikes":"14","slots":"10","zip":"2018","address":"Rubenslei \u2013 Louiza \u2013 Marialei ","addressNumber":null,"nearbyStations":"37,41,77,95","status":"OPN","name":"096- Stadspark"},{"id":"97","district":"1","lon":"4.428828981041583000","lat":"51.20277981255939000","bikes":"7","slots":"13","zip":"2018","address":"Cuperusstraat ro Lange Leemstraat","addressNumber":null,"nearbyStations":"8,22,47,106","status":"OPN","name":"097- Cuperus"},{"id":"98","district":"1","lon":"4.418930242293162000","lat":"51.19983991136949000","bikes":"13","slots":"8","zip":"2018","address":"Boomgaardstraat 31","addressNumber":null,"nearbyStations":"42,43,46,47","status":"OPN","name":"098- Haringrode"},{"id":"99","district":"1","lon":"4.410264715254410000","lat":"51.19706006771547000","bikes":"5","slots":"18","zip":"2018","address":"Generaal Lemanstraat - Karel Oomsstraat","addressNumber":null,"nearbyStations":"14,31,46,131","status":"OPN","name":"099- Generaal Leman"},{"id":"100","district":"1","lon":"4.416600409370835000","lat":"51.19485112984604000","bikes":"11","slots":"22","zip":"2600","address":"Frans Van Hombeeckplein 25","addressNumber":null,"nearbyStations":"21,46,103,131","status":"OPN","name":"100- Van Hombeeckplein"},{"id":"101","district":null,"lon":"4.432000000000000000","lat":"51.22410000000000000","bikes":"16","slots":"20","zip":"2060","address":"Lange Stuivenbergstraat ","addressNumber":"tov 90","nearbyStations":"102,114,121,122","status":"OPN","name":"101- Premetro Handel"},{"id":"102","district":null,"lon":"4.430256657794283000","lat":"51.22246101471936000","bikes":"10","slots":"25","zip":"2060","address":"Duinstraat","addressNumber":null,"nearbyStations":"101,109,114,115","status":"OPN","name":"102- Duinstraat"},{"id":"103","district":"1","lon":"4.421033928187006000","lat":"51.19294514056712000","bikes":"13","slots":"10","zip":"2600","address":"Heilig Hartstraat","addressNumber":null,"nearbyStations":"21,55,100,131","status":"OPN","name":"103- Oude Kerk Berchem"},{"id":"104","district":"1","lon":"4.424294009067518000","lat":"51.20820781231681000","bikes":"7","slots":"11","zip":"2018","address":"Provinciestraat - Mercatorstraat","addressNumber":null,"nearbyStations":"6,110,111,116","status":"OPN","name":"104- Mercator"},{"id":"105","district":"1","lon":"4.432625218239298000","lat":"51.20902773858518000","bikes":"3","slots":"18","zip":"2018","address":"Plantin Moretuslei n\u00b0 158","addressNumber":null,"nearbyStations":"9,106,110,111","status":"OPN","name":"105- Plantin en Moretus"},{"id":"106","district":"1","lon":"4.432210218293591000","lat":"51.20560903628581000","bikes":"13","slots":"8","zip":"2600","address":"Draakplaats","addressNumber":null,"nearbyStations":"8,97,110,112","status":"OPN","name":"106- Draakplaats"},{"id":"107","district":"1","lon":"4.433276632960023000","lat":"51.21366084739251000","bikes":"11","slots":"7","zip":"2140","address":"Moorkensplein ro n\u00b0 33A","addressNumber":null,"nearbyStations":"30,39,105,132","status":"OPN","name":"107- Moorkensplein"},{"id":"108","district":null,"lon":"4.439968641906528000","lat":"51.21602303185675000","bikes":"2","slots":"2","zip":"2140","address":"Delaraystraat ro n\u00b0 13","addressNumber":null,"nearbyStations":"30,68,107,113","status":"NOPN","name":"108- Krugerpark"},{"id":"109","district":"1","lon":"4.430513466501682000","lat":"51.21857958532913000","bikes":"2","slots":"18","zip":"2060","address":"Kerkstraat n\u00b0 58","addressNumber":null,"nearbyStations":"30,38,108,113","status":"OPN","name":"109- Kerkstraat"},{"id":"110","district":null,"lon":"4.430101723012998000","lat":"51.20694317094480000","bikes":"2","slots":"34","zip":"2018","address":"Dageraadplaats","addressNumber":null,"nearbyStations":"104,105,106,111","status":"OPN","name":"110- Dageraadplaats"},{"id":"111","district":"1","lon":"4.427400000000000000","lat":"51.21020000000000000","bikes":"5","slots":"31","zip":"2018","address":"Plantin en Moretuslei","addressNumber":"10","nearbyStations":"6,104,105,110","status":"OPN","name":"111- Van Der Meyden"},{"id":"112","district":null,"lon":"4.436840753419609000","lat":"51.20344626609609000","bikes":"7","slots":"29","zip":"2600","address":"Uitbreidingstraat","addressNumber":"578","nearbyStations":"8,22,97,106","status":"OPN","name":"112- Pretoriastraat"},{"id":"113","district":"1","lon":"4.438622043829003000","lat":"51.21860899599756000","bikes":"11","slots":"6","zip":"2140","address":"Vercammenstraat - Helmstraat","addressNumber":null,"nearbyStations":"30,38,108,109","status":"OPN","name":"113- Helmstraat"},{"id":"114","district":"1","lon":"4.433777992711939000","lat":"51.22205311877087000","bikes":"7","slots":"13","zip":"2060","address":"Pesthofstraat ro n\u00b0 5","addressNumber":null,"nearbyStations":"38,101,102,122","status":"OPN","name":"114- ZNA Stuivenberg"},{"id":"115","district":"1","lon":"4.424183815656882000","lat":"51.22275442340224000","bikes":"3","slots":"18","zip":"2060","address":"Sint Elisabethstraat - Greinstraat","addressNumber":null,"nearbyStations":"32,101,102,125","status":"OPN","name":"115- Metro Elisabeth"},{"id":"116","district":"1","lon":"4.417215972702701000","lat":"51.21009600631509000","bikes":"0","slots":"18","zip":"2018","address":"Van Eycklei ro n\u00b0 48","addressNumber":null,"nearbyStations":"5,6,41,95","status":"OPN","name":"116- Loosplaats"},{"id":"117","district":"1","lon":"4.418404418360266000","lat":"51.22541936981867000","bikes":"1","slots":"29","zip":"2060","address":"Sint Jansplein ro n\u00b0 17","addressNumber":null,"nearbyStations":"52,53,118,125","status":"OPN","name":"117- Sint Jansplein"},{"id":"118","district":"1","lon":"4.422247361006011000","lat":"51.22714208703280000","bikes":"15","slots":"6","zip":"2060","address":"Trapstraat n\u00b0 10","addressNumber":null,"nearbyStations":"123,124,125,126","status":"OPN","name":"118- Dambrugge"},{"id":"119","district":null,"lon":"4.425367882174795000","lat":"51.21537176619199000","bikes":"12","slots":"12","zip":"2018","address":"Provinciestraat (plein)","addressNumber":null,"nearbyStations":"1,2,3,5","status":"OPN","name":"119- Ploeg"},{"id":"121","district":"1","lon":"4.430533809533261000","lat":"51.22746041947940000","bikes":"14","slots":"16","zip":"2060","address":"Stuivenbergplein ro n\u00b0 36-1","addressNumber":null,"nearbyStations":"63,101,122,123","status":"OPN","name":"121- Stuivenbergplein"},{"id":"122","district":"1","lon":"4.436567207739302000","lat":"51.22470882205263000","bikes":"0","slots":"21","zip":"2060","address":"Pothoekstraat ro n\u00b0 124","addressNumber":null,"nearbyStations":"101,114,121","status":"OPN","name":"122- Schijnpoort"},{"id":"123","district":"1","lon":"4.424935536896917000","lat":"51.22903876862169000","bikes":"7","slots":"11","zip":"2060","address":"Vis\u00e9straat 16","addressNumber":null,"nearbyStations":"62,63,118,124","status":"OPN","name":"123- Park Spoor Noord 2"},{"id":"124","district":"1","lon":"4.419613000000000000","lat":"51.22996200000000000","bikes":"13","slots":"17","zip":"2060","address":"Ellermansstraat \u2013 Fuggerstraat","addressNumber":null,"nearbyStations":"118,123,126,127","status":"OPN","name":"124- Park Spoor Noord 1"},{"id":"125","district":null,"lon":"4.423474198206600000","lat":"51.22595564552162000","bikes":"14","slots":"22","zip":"2060","address":"Sint-Norbertusstraat\/Van Kerckhovenstraat","addressNumber":null,"nearbyStations":"115,117,118,123","status":"OPN","name":"125- Sint-Norbertus"},{"id":"126","district":null,"lon":"4.419015786408293000","lat":"51.22805003403131000","bikes":"15","slots":"21","zip":"2060","address":"Lange Dijkstraat 46\/ Van Aerdtstraat","addressNumber":null,"nearbyStations":"118,123,124,125","status":"OPN","name":"126- Lange Dijk"},{"id":"127","district":"1","lon":"4.413307095780299000","lat":"51.22857844475766000","bikes":"5","slots":"25","zip":"2000","address":"Itali\u00eblei n\u00b0 4","addressNumber":null,"nearbyStations":"52,129,133,139","status":"OPN","name":"127- FOD Financi\u00ebn"},{"id":"129","district":"1","lon":"4.408800000000000000","lat":"51.22840000000000000","bikes":"24","slots":"11","zip":"2000","address":"Godefriduskaai Qpark","addressNumber":null,"nearbyStations":"45,133,134,137","status":"OPN","name":"129- Godefriduskaai"},{"id":"130","district":"1","lon":"4.420800000000000000","lat":"51.20380000000000000","bikes":"9","slots":"9","zip":"2000","address":"Lamorini\u00e8restraat","addressNumber":"150","nearbyStations":"43,44,47,97","status":"OPN","name":"130- Lamoriniere"},{"id":"131","district":"1","lon":"4.412152929349810000","lat":"51.19375625338252000","bikes":"15","slots":"6","zip":"2600","address":"De wittestraat - Generaal Lemanstraat","addressNumber":null,"nearbyStations":"21,31,99,100","status":"OPN","name":"131- De Wittestraat"},{"id":"132","district":"1","lon":"4.437785965534147000","lat":"51.21177359796551000","bikes":"9","slots":"8","zip":"2140","address":"Maarschalk Montgomeryplein ro n\u00b0 4","addressNumber":null,"nearbyStations":"9,39,69,107","status":"OPN","name":"132- Montgomery"},{"id":"133","district":"1","lon":"4.411349321449047000","lat":"51.22958146712338000","bikes":"10","slots":"14","zip":"2000","address":"Entrepotkaai n\u00b0 1","addressNumber":null,"nearbyStations":"127,129,134,137","status":"OPN","name":"133- Willemdok"},{"id":"134","district":"1","lon":"4.405728642058911000","lat":"51.22811203740126000","bikes":"3","slots":"21","zip":"2000","address":"Godefriduskaai - Oostendekaai","addressNumber":null,"nearbyStations":"45,129,133,137","status":"OPN","name":"134- MAS"},{"id":"135","district":"1","lon":"4.400551181658024000","lat":"51.22682311529312000","bikes":"7","slots":"20","zip":"1000","address":"Van Meterenkaai - Brouwersvliet","addressNumber":null,"nearbyStations":"45,50,58","status":"OPN","name":"135- Loodswezen"},{"id":"137","district":null,"lon":"4.405748000000000000","lat":"51.22977900000000000","bikes":"12","slots":"24","zip":"2000","address":"napeleonkaai\/Nassaustraat ","addressNumber":null,"nearbyStations":"129,133,134,138","status":"OPN","name":"137- Sint-Laureiskaai"},{"id":"138","district":null,"lon":"4.403552339080501000","lat":"51.23119852755470000","bikes":"3","slots":"20","zip":"2000","address":"Amsterdamstraat","addressNumber":null,"nearbyStations":"133,134,137,139","status":"OPN","name":"138- Amsterdamstraat"},{"id":"139","district":null,"lon":"4.412669394282471000","lat":"51.23105348045673000","bikes":"1","slots":"20","zip":"2000","address":"Londenstraat","addressNumber":"53","nearbyStations":"127,133,137,138","status":"OPN","name":"139- Londenstraat"},{"id":"140","district":null,"lon":"4.391627018623872000","lat":"51.23142266636172000","bikes":"12","slots":"23","zip":"2050","address":"Goethestraat\/Thoneth","addressNumber":"Goethestraat\/Thoneth","nearbyStations":"141,142,144,146","status":"OPN","name":"140- Jachthaven LO"},{"id":"141","district":null,"lon":"4.386875385241651000","lat":"51.23525257003270000","bikes":"10","slots":"25","zip":"2050","address":"Gloriantlaan\/Kastanjedreef","addressNumber":null,"nearbyStations":"140,142,144,146","status":"OPN","name":"141- Sint-Anna"},{"id":"142","district":null,"lon":"4.382542133810354000","lat":"51.23343998005640000","bikes":"20","slots":"16","zip":"2050","address":"Esmoreitlaan","addressNumber":"25","nearbyStations":"141,144,145,146","status":"OPN","name":"142- Esmoreitlaan"},{"id":"143","district":null,"lon":"4.386179000000000000","lat":"51.23114600000000000","bikes":"9","slots":"15","zip":"2050","address":"Gloriantlaan\/Melis Stokelaan 24  ","addressNumber":null,"nearbyStations":"140,141,142,146","status":"OPN","name":"143- Melis Stokelaan"},{"id":"144","district":null,"lon":"4.378669800971490000","lat":"51.23126710565874000","bikes":"8","slots":"28","zip":"2050","address":"August Vermeylenlaan","addressNumber":"tov 7","nearbyStations":"141,142,145,146","status":"OPN","name":"144- August Vermeylenlaan"},{"id":"145","district":null,"lon":"4.378550835716943000","lat":"51.22784221343208000","bikes":"4","slots":"19","zip":"2050","address":"August Vermeylenlaan\/ Charles de Costerlaan","addressNumber":null,"nearbyStations":"142,144,146,147","status":"OPN","name":"145- De Coster"},{"id":"146","district":null,"lon":"4.385890517853628000","lat":"51.22777877150836000","bikes":"12","slots":"21","zip":"2050","address":"Gloriantlaan\/Reinaartlaan","addressNumber":null,"nearbyStations":"140,144,145,147","status":"OPN","name":"146- Reinaartlaan"},{"id":"147","district":null,"lon":"4.377876746950817000","lat":"51.22391870297562000","bikes":"10","slots":"12","zip":"2050","address":"Halewijnlaan","addressNumber":"86","nearbyStations":"148,150,151,152","status":"OPN","name":"147- Halewijnlaan"},{"id":"148","district":null,"lon":"4.386220088490688000","lat":"51.22319820902703000","bikes":"17","slots":"19","zip":"2050","address":"Frederik Van Eedenstraa","addressNumber":" tov nr 4","nearbyStations":"146,147,149,150","status":"OPN","name":"148- Verhaerenlaan"},{"id":"149","district":null,"lon":"4.386331953024964000","lat":"51.22061309991433000","bikes":"24","slots":"12","zip":"2050","address":"Blancefloerlaan tov Frederik van Eedenplein","addressNumber":null,"nearbyStations":"148,150,151,153","status":"OPN","name":"149- Van Eedenplein"},{"id":"150","district":null,"lon":"4.381723278952854000","lat":"51.22007348867427000","bikes":"18","slots":"6","zip":"2050","address":"Waterhoenlaan","addressNumber":"12","nearbyStations":"149,151,152,153","status":"OPN","name":"150- Waterhoenlaan"},{"id":"151","district":null,"lon":"4.378407092993419000","lat":"51.22031300886957000","bikes":"24","slots":"12","zip":"2050","address":"Blancefloerlaan\/Halewijnlaan","addressNumber":null,"nearbyStations":"149,150,152,153","status":"OPN","name":"151- Van Cauwelaert"},{"id":"152","district":null,"lon":"4.375590099454385000","lat":"51.22007304015533000","bikes":"22","slots":"11","zip":"2050","address":"Blancefloerlaan","addressNumber":"161","nearbyStations":"147,149,150,151","status":"OPN","name":"152- Blancefloerlaan"},{"id":"153","district":null,"lon":"4.385706443546232000","lat":"51.21852860322108000","bikes":"18","slots":"18","zip":"2050","address":"Beatrijslaan","addressNumber":"42","nearbyStations":"148,149,150,151","status":"OPN","name":"153- Beatrijslaan"}];

			$.map(data, function(val) {
                    		val.name = val.name.substring(0,3)+" - "+val.name.substring(5);
		        	val.saved = $.inArray(val.id,$localStorage.savedStations) > -1; 
				// save some memory by removing unused items
				delete val.district;
				delete val.zip;
				delete val.address;
				delete val.addressNumber;
			});
			return data;
	  	}

	  }
	  return service;
    }
  ]);
